(function(b){function d(a){if(!(this instanceof d))return new d(a);this.set_options(a);if(!this.options.url)this.is_loaded=!0;return this}if("undefined"!==typeof b){b(window).on("resize.modal_dialog",function(){var a=b(".nc-modal-dialog:visible").data("modal_dialog");a&&a.resize&&a.resize()});var e=null;d.get_opened_dialog=function(){return e};d.prototype={options:{url:null,persist:!1,on_show:b.noop,on_resize:b.noop,min_width:600,max_width:1200,full_markup:'<div class="nc-modal-dialog"><div class="nc-modal-dialog-header"><h2>&nbsp;</h2><div class="nc-modal-dialog-header-tabs"><ul><li></li></ul></div></div><div class="nc-modal-dialog-body"></div><div class="nc-modal-dialog-footer"></div></div>'},
loaded_markup:null,dialog_container:null,parts:{title:".nc-modal-dialog-header h2",tabs:".nc-modal-dialog-header-tabs",body:".nc-modal-dialog-body",footer:".nc-modal-dialog-footer"},is_loaded:!1,is_open:!1,set_options:function(a){this.options=b.extend(this.options,a)},load:function(){var a=this;return b.get(this.options.url).done(function(c){a.loaded_markup=b.trim(c)}).always(function(){a.is_loaded=!0})},create:function(){if(!this.is_loaded)return nc.process_start("ui.modal_dialog.load"),this.load().done(b.proxy(this,
"create"));nc.process_stop("ui.modal_dialog.load",0);var a=this.options;this.loaded_markup&&b(this.loaded_markup).is(".nc-modal-dialog")?a=b(this.loaded_markup):(a=b(a.full_markup),this.loaded_markup&&a.find(".nc-modal-dialog-body").append(this.loaded_markup));this.dialog_container=a.hide().data("modal_dialog",this).appendTo("body");this.get_part("footer").find("button[data-role=close]").on("click.modal_dialog",b.proxy(this,"close"));return b.Deferred().resolve()},open:function(){e&&e.close();this.dialog_container?
this.when_ready_to_open():this.create().done(b.proxy(this,"when_ready_to_open"))},when_ready_to_open:function(){b.modal(this.dialog_container,{onShow:b.proxy(this,"on_show"),persist:this.options.persist,closeHTML:'<a class="modalCloseImg" title="'+ncLang.Close+'"></a>'});this.is_open=!0;e=this;this.resize()},on_show:function(){this.options.on_show(this)},close:function(){if(this.is_open)b.modal.close(),this.is_open=!1,e=null,this.options.persist||this.dialog_container.remove()},resize:function(){if(this.is_open){var a=
b(top.window),c=a.width()-200,d=a.height()-200;if(c>this.options.max_width)c=this.options.max_width;if(c<this.options.min_width)c=this.options.min_width;b("#simplemodal-container").css({width:c+"px",height:d+"px",left:Math.round((a.width()-c)/2-10)+"px",top:"100px"}).find(".simplemodal-wrap").css("overflow","auto");this.options.on_resize()}},destroy:function(){this.close();this.dialog_container.remove()},clear_all:function(){for(var a in this.parts)this.clear(a)},clear_part:function(a){this.get_part(a).empty()},
find:function(a){this.dialog_container||this.create();return this.dialog_container.find(a)},get_part:function(a){return this.find(this.parts[a])}};nc.ext("modal_dialog",d,"ui")}})(window.top.$nc);
